---
title: 【独学メモ】キルヒホッフの法則のホモロジー/コホモロジー的解釈
tags:
  - '#電気回路'
private: false
updated_at: '2025-11-09T19:27:04+09:00'
id: c23b4b201418aacf945a
organization_url_name: null
slide: false
ignorePublish: false
---
:::note warn
これは自分の理解の整理用メモです。誤りがあればご指摘ください。
:::

```math
\DeclareMathOperator{\div}{div}
\DeclareMathOperator{\rot}{rot}
\DeclareMathOperator{\ker}{Ker}
\DeclareMathOperator{\im}{Im}
```

# KCL & KVL

- **キルヒホッフの第一法則**（電流則：KCL）
  各節点において、電流の流入量と流出量は等しい。
  ＝流れの収支が0
- **キルヒホッフの第二法則**（電圧則：KVL）
  各閉路において、起電力の総和と電圧降下の合計は等しい。
  ＝電位差の周回積分が0

<!--回路はもともと電磁気学、つまり電場というベクトル場が元になっている。上記はそれぞれ、$\div J = 0 $ と $\rot E =0 $ に対応している。-->


## キルヒホッフの電流則を行列で表す

下図のような回路を考える。

![キルヒホッフ回路.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/3551504/68ec301e-cc30-471f-b347-77a2095a8b15.png)

節点を大きく描いてしまったが、**素子は辺に取り付けられる**ことに注意。各辺が抵抗 $r_k$、電流 $i_k$、電位差 $v_k$ という3つのパラメータを持つ。

### 境界演算子

「この辺の始点と終点はどこか？」を表す行列 $\partial_1$ を作る（境界演算子）。

```math
\partial_1 = \left(\begin{matrix}
-1 & 0 & 0 & 1 \\
1 & -1 & -1 & 0 \\
0 & 1 & 1 & -1 \\
\end{matrix}\right)
```

各列を見ると始点のところには $-1$ が、終点のところには $1$ が入っている。

使い方としては、例えば辺 $e_2$ の両端が何の頂点なのか調べるには、$e_2$ に対応するベクトル $(0\\ 1\\ 0\\ 0)^\top$ を掛け算すればよい。

```math
\partial_1 e_2 = \left(\begin{matrix}
-1 & 0 & 0 & 1 \\
1 & -1 & -1 & 0 \\
0 & 1 & 1 & -1 \\
\end{matrix}\right) \left(\begin{matrix}
0 \\
1 \\
0 \\
0 \\
\end{matrix}\right)
= \left(\begin{matrix}
0 \\
-1 \\
1 \\
\end{matrix}\right)
= p_3 - p_2
```

（※$p_2$ と $p_3$ に対応するベクトルはそれぞれ $(0\\ 1\\ 0)^\top$ と $(0\\ 0\\ 1)^\top$ である）
これは $e_2$ が「*$p_2$ から $p_3$ に向かう辺*」であることを表す。このようにして辺の両端＝境界を求められるのが境界演算子である。


### 余境界演算子

「この頂点にはどの辺が接続されているか？」を表す行列も作成しておく（余境界演算子）。
と言っても、先ほどの $\partial_1$ を転置するだけである。

```math
\delta^0 = \partial_1^\top = \left(\begin{matrix}
-1 & 1 & 0 \\
0 & -1 & 1 \\
0 & -1 & 1 \\
1 & 0 & -1 \\
\end{matrix}\right)
```

使い方は似ていて、頂点 $p_2$ に繋がっている辺を調べたいならば、ベクトル $(0\\ 1\\ 0)^\top$ を掛けて

```math
\delta^0 p_2 = \left(\begin{matrix}
-1 & 1 & 0 \\
0 & -1 & 1 \\
0 & -1 & 1 \\
1 & 0 & -1 \\
\end{matrix}\right) \left(\begin{matrix}
0 \\
1 \\
0 \\
\end{matrix}\right)
= \left(\begin{matrix}
1 \\
-1 \\
-1 \\
0 \\
\end{matrix}\right)
= e_1 - e_2 - e_3
```

を得る。これは辺 $e_1$ に指し示されて、$e_2$ と $e_3$ が出て行っていることを表す。


### 境界演算子を用いて電流則を表す

上記の行列を使えば、キルヒホッフの第一法則に登場する「節点への流入・流出」という概念をちょうど上手く表せそうである。

各辺にとりあえず電流値を割り当ててみる。$e_1$ ～ $e_4$ の順に $5A, 2A, 3A, 5A$ の電流が流れているとしよう。これをベクトルで書き表し、電流ベクトルと呼ぶ。

```math
\boldsymbol{i} = \left(\begin{matrix}
i_1 \\
i_2 \\
i_3 \\
i_4 \\
\end{matrix}\right)
= \left(\begin{matrix}
5 \\
2 \\
3 \\
5 \\
\end{matrix}\right)
```

この電流ベクトルに $\delta^0$ を掛け算するとどうなるだろう。実際にやってみると、

```math
\delta^0 \boldsymbol{i} = \left(\begin{matrix}
-1 & 1 & 0 \\
0 & -1 & 1 \\
0 & -1 & 1 \\
1 & 0 & -1 \\
\end{matrix}\right) \left(\begin{matrix}
5 \\
2 \\
3 \\
5 \\
\end{matrix}\right)
```

…うまく行かない。代わりに境界演算子 $\partial_1$ なら？

```math
\partial_1 \boldsymbol{i} = \left(\begin{matrix}
-1 & 0 & 0 & 1 \\
1 & -1 & -1 & 0 \\
0 & 1 & 1 & -1 \\
\end{matrix}\right) \left(\begin{matrix}
5 \\
2 \\
3 \\
5 \\
\end{matrix}\right)
= \left(\begin{matrix}
-5 + 5 \\
5 - 2 - 3\\
2 + 3 - 5 \\
\end{matrix}\right)
```

計算できた。そしてなんと、**ベクトルの各要素が「各頂点の電流収支」を表している**。

![キルヒホッフ回路電流.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/3551504/b9dbb54f-e150-40b8-9ff9-083dd3de82da.png)

キルヒホッフの第一法則とは「各頂点の電流収支が $0$」であるという主張そのものだ。すなわち上のベクトルがゼロベクトルになる。

```math
\partial_1 \boldsymbol{i} = \boldsymbol{0}
```

これが電流則の行列表現である！



## キルヒホッフの電圧則を行列で表す

先ほどと同じ回路を考える。

### 余境界演算子を用いて電圧則を表す

閉路がどこにあるのかを示す行列 $\partial_2, \delta^1$ も同じ要領で作ってみる。ホモロジー的に言うと、これらを $\partial_1$ から自動で求められれば良いのだが、残念ながら手動で作るしかなさそう（要検証）。


```math
\partial_2 = \left(\begin{matrix}
1 & 0 \\
0 & 1 \\
1 & -1 \\
1 & 0 \\
\end{matrix}\right)
,\
\delta^1 = \partial_2^\top = \left(\begin{matrix}
1 & 0 & 1 & 1 \\
0 & 1 & -1 & 0 \\
\end{matrix}\right)
```

電圧ベクトルも適当な値で用意しておく。$e_1$ に $20\ V$ の電池が付いているイメージ。

```math
\boldsymbol{v} = \left(\begin{matrix}
v_1 \\
v_2 \\
v_3 \\
v_4 \\
\end{matrix}\right)
= \left(\begin{matrix}
20 \\
-8 \\
-8 \\
-12 \\
\end{matrix}\right)
```

起電力はプラス、電圧降下はマイナス。この $\boldsymbol{v}$ に $\delta^1$ を掛けてみると、

```math
\delta^1 \boldsymbol{v} = \left(\begin{matrix}
1 & 0 & 1 & 1 \\
0 & 1 & -1 & 0 \\
\end{matrix}\right) \left(\begin{matrix}
20 \\
-8 \\
-8 \\
-12 \\
\end{matrix}\right)
= \left(\begin{matrix}
20 - 8 - 12 \\
-8 + 8 \\
\end{matrix}\right)
```

**ベクトルの各要素が「閉路ごとの電位差の総和」に等しくなる**。

![キルヒホッフ回路電圧.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/3551504/c79b8768-d5c2-403d-9968-c28a8364ad27.png)

キルヒホッフの第二法則とは「閉路ごとの電位差の総和が0」という主張そのものであるから、やはり

```math
\delta^1 \boldsymbol{v} = \boldsymbol{0}
```

となる。これが電圧則の行列表現である。

<!--
ここまでを整理した表が以下となる。

| 法則 | 行列表現 |
|:-----------|:------------:|
| 電流則 | $\partial_1 \boldsymbol{i} = \boldsymbol{0}$ | $\boldsymbol{i} \in \ker \partial_1$ |
| 電圧則 | $\delta_1 \boldsymbol{v} = \boldsymbol{0}$ | $\boldsymbol{v} \in \ker \delta_1$ |
-->

:::note info
電流則は $\partial_1 \boldsymbol{i} = \boldsymbol{0}$ 、電圧則は $\delta^1 \boldsymbol{v} = \boldsymbol{0}$ 。非常に美しい。
:::

### 電圧則の別の表現

周回積分が常に0であるということは、電場がポテンシャル場であることを意味する。したがって、各頂点に電位

```math
\boldsymbol{\phi} = \left(\begin{matrix}
\phi_1 \\
\phi_2 \\
\phi_3 \\
\phi_4 \\
\end{matrix}\right)
```

を定義でき、電場ベクトル $\boldsymbol{v}$ は $\boldsymbol{\phi}$ に余境界作用素 $\delta^0$ を作用させてのみ得られることになる。つまり

```math
\boldsymbol{v} \in \im \delta^0
```

これがキルヒホッフの第二法則の、もう一つの定式化である。

ところで、前節で示した表現 $\delta^1 \boldsymbol{v} = \boldsymbol{0}$ は核（カーネル）を用いて

```math
\boldsymbol{v} \in \ker \delta^1
```

とも表せる。$\ker \delta^1 = \im \delta^0$ ということか。


## 核と像による表現

まとめると、

- 電流則の同値な表現：
  - $\partial_1 \boldsymbol{i} = \boldsymbol{0}$
  - $\boldsymbol{i} \in \ker \partial_1$
  - $\boldsymbol{i} \in \im \partial_2$
- 電圧則の同値な表現：
  - $\delta^1 \boldsymbol{v} = \boldsymbol{0}$
  - $\boldsymbol{v} \in \ker \delta^1$
  - $\boldsymbol{v} \in \im \delta^0$

# 参考文献

キルヒホッフの法則と基本カットセット行列 https://imaginary-blog-im.com/cutset/
