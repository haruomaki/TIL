# 対数特性関数（キュムラント母関数）

特性関数 $\varphi(t) = \mathbb{E}[e^{itX}]$ とその対数 $\psi(t) = \log \varphi(t)$ の関係。それぞれをテイラー展開すれば

```math
\varphi(t) = \sum_{n=0}^\infty \mu_n \frac{(it)^n}{n!}
```

```math
\psi(t) = \sum_{n=0}^\infty \kappa_n \frac{(it)^n}{n!}
```

 と書くことができる。ただし

```math
\begin{align}
\mu_0 &= \varphi(0) = \mathbb{E}[e^0] = 1 \\
\kappa_0 &= \psi(0) = \log \varphi(0) = 0
\end{align}
```

であることに注意。

$\psi(t) = \log \varphi(t)$ の両辺を微分する。

```math
\begin{align}
\psi'(t) &= \frac{\varphi'(t)}{\varphi(t)} \\
\psi'(t) \varphi(t) &= \varphi'(t) \\
\left( i \sum_{n=1}^\infty \kappa_n \frac{(it)^{n-1}}{(n-1)!} \right) \left( \sum_{n=0}^\infty \mu_n \frac{(it)^n}{n!} \right) &= i \sum_{n=1}^\infty \mu_n \frac{(it)^{n-1}}{(n-1)!} \\
\left( \sum_{n=0}^\infty \kappa_{n+1} \frac{(it)^n}{n!} \right) \left( \sum_{n=0}^\infty \mu_n \frac{(it)^n}{n!} \right) &= \sum_{n=0}^\infty \mu_{n+1} \frac{(it)^n}{n!} \\

\end{align}
```

両辺の $(it)^n$ の係数を比較する。

```math
\sum_{k=0}^n \frac{\kappa_{k+1}}{k!} \cdot \frac{\mu_{n-k}}{(n-k)!} = \frac{\mu_{n+1}}{n!}
\hspace{1em} (n \ge 0)
```

したがって

```math
\begin{align}
\mu_{n+1} &= \sum_{k=0}^n \frac{n!}{k!(n-k)!} \kappa_{k+1} \mu_{n-k} \\
          &= \sum_{k=0}^n \binom{n}{k} \kappa_{k+1} \mu_{n-k} \\
\end{align}
```

$\mu_n$ の漸化式が得られる。

目標としては $\kappa_n$ の漸化式を求めたい。$k=n$ の項は

```math
\binom{n}{n} \kappa_{n+1} \mu_0 = \kappa_{n+1} \\
\hspace{1em} (\because \mu_0 = 1)
```

であるから

```math
\begin{dcases}
\kappa_0 &= 0 \\
\kappa_1 &= \mu_1 \\
\kappa_{n+1} &= \mu_{n+1} - \sum_{k=0}^{n-1} \binom{n}{k} \kappa_{k+1} \mu_{n-k} & (n \ge 1)
\end{dcases}
```

を得る。

# 実際に計算

原点周りのモーメントを用いる。

```math
\begin{aligned}
  \kappa_{1} &= \mu_{1} \\
  \kappa_{2} &= \mu_{2} - \mu_{1}^{2} \\
  \kappa_{3} &= \mu_{3} - 3 \mu_{1} \mu_{2} + 2 \mu_{1}^{3} \\
  \kappa_{4} &= \mu_{4} - 3 \mu_{2}^{2} - 4 \mu_{1} \mu_{3} + 12 \mu_{1}^{2} \mu_{2} - 6 \mu_{1}^{4} \\
  \kappa_{5} &= \mu_{5} - 10 \mu_{2} \mu_{3} - 5 \mu_{1} \mu_{4} + 30 \mu_{1} \mu_{2}^{2} + 20 \mu_{1}^{2} \mu_{3} - 60 \mu_{1}^{3} \mu_{2} + 24 \mu_{1}^{5} \\
  \kappa_{6} &= \mu_{6} - 10 \mu_{3}^{2} - 15 \mu_{2} \mu_{4} + 30 \mu_{2}^{3} - 6 \mu_{1} \mu_{5} + 120 \mu_{1} \mu_{2} \mu_{3} + 30 \mu_{1}^{2} \mu_{4} - 270 \mu_{1}^{2} \mu_{2}^{2} - 120 \mu_{1}^{3} \mu_{3} + 360 \mu_{1}^{4} \mu_{2} - 120 \mu_{1}^{6} \\
  \kappa_{7} &= \mu_{7} - 35 \mu_{3} \mu_{4} - 21 \mu_{2} \mu_{5} + 210 \mu_{2}^{2} \mu_{3} - 7 \mu_{1} \mu_{6} + 140 \mu_{1} \mu_{3}^{2} + 210 \mu_{1} \mu_{2} \mu_{4} - 630 \mu_{1} \mu_{2}^{3} + 42 \mu_{1}^{2} \mu_{5} - 1260 \mu_{1}^{2} \mu_{2} \mu_{3} - 210 \mu_{1}^{3} \mu_{4} + 2520 \mu_{1}^{3} \mu_{2}^{2} + 840 \mu_{1}^{4} \mu_{3} - 2520 \mu_{1}^{5} \mu_{2} + 720 \mu_{1}^{7} \\
\end{aligned}
```

また、平均モーメントを用いると以下のようになる（$\mu_1 = 0$）。


```math
\begin{aligned}
  \kappa_{1} &= 0 \\
  \kappa_{2} &= \mu_{2} \\
  \kappa_{3} &= \mu_{3} \\
  \kappa_{4} &= \mu_{4} - 3 \mu_{2}^{2} \\
  \kappa_{5} &= \mu_{5} - 10 \mu_{2} \mu_{3} \\
  \kappa_{6} &= \mu_{6} - 10 \mu_{3}^{2} - 15 \mu_{2} \mu_{4} + 30 \mu_{2}^{3} \\
  \kappa_{7} &= \mu_{7} - 35 \mu_{3} \mu_{4} - 21 \mu_{2} \mu_{5} + 210 \mu_{2}^{2} \mu_{3} \\
  \kappa_{8} &= \mu_{8} - 35 \mu_{4}^{2} - 56 \mu_{3} \mu_{5} - 28 \mu_{2} \mu_{6} + 560 \mu_{2} \mu_{3}^{2} + 420 \mu_{2}^{2} \mu_{4} - 630 \mu_{2}^{4} \\
  \kappa_{9} &= \mu_{9} - 126 \mu_{4} \mu_{5} - 84 \mu_{3} \mu_{6} + 560 \mu_{3}^{3} - 36 \mu_{2} \mu_{7} + 2520 \mu_{2} \mu_{3} \mu_{4} + 756 \mu_{2}^{2} \mu_{5} - 7560 \mu_{2}^{3} \mu_{3} \\
\end{aligned}
```
