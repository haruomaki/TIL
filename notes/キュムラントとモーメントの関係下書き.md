# 対数特性関数（キュムラント母関数）

特性関数 $\varphi(t)$ とその対数 $\psi(t) = \log \varphi(t)$ の関係。それぞれをテイラー展開すれば

```math
\varphi(t) = \sum_{n=0}^\infty \mu_n \frac{(it)^n}{n!}
```

```math
\psi(t) = \sum_{n=0}^\infty \pi_n \frac{(it)^n}{n!}
```

 と書くことができる。ただし

```math
\begin{align}
\mu_0 &= \varphi(0) = \mathbb{E}[e^0] = 1 \\
\pi_0 &= \psi(0) = \log \varphi(0) = 0
\end{align}
```

であることに注意。

$\psi(t) = \log \varphi(t)$ の両辺を微分する。

```math
\begin{align}
\psi'(t) &= \frac{\varphi'(t)}{\varphi(t)} \\
\psi'(t) \varphi(t) &= \varphi'(t) \\
\left( i \sum_{n=1}^\infty \pi_n \frac{(it)^{n-1}}{(n-1)!} \right) \left( \sum_{n=0}^\infty \mu_n \frac{(it)^n}{n!} \right) &= i \sum_{n=1}^\infty \mu_n \frac{(it)^{n-1}}{(n-1)!} \\
\left( \sum_{n=0}^\infty \pi_{n+1} \frac{(it)^n}{n!} \right) \left( \sum_{n=0}^\infty \mu_n \frac{(it)^n}{n!} \right) &= \sum_{n=0}^\infty \mu_{n+1} \frac{(it)^n}{n!} \\

\end{align}
```

両辺の $(it)^n$ の係数を比較する。

```math
\sum_{k=0}^n \frac{\pi_{k+1}}{k!} \cdot \frac{\mu_{n-k}}{(n-k)!} = \frac{\mu_{n+1}}{n!}
\hspace{1em} (n \ge 0)
```

したがって

```math
\begin{align}
\mu_{n+1} &= \sum_{k=0}^n \frac{n!}{k!(n-k)!} \pi_{k+1} \mu_{n-k} \\
          &= \sum_{k=0}^n \binom{n}{k} \pi_{k+1} \mu_{n-k} \\
\end{align}
```

$\mu_n$ の漸化式が得られる。

目標としては $\pi_n$ の漸化式を求めたい。$k=n$ の項は

```math
\binom{n}{n} \pi_{n+1} \mu_0 = \pi_{n+1} \\
\hspace{1em} (\because \mu_0 = 1)
```

だから

```math
\require{mathtools}
\begin{dcases}
\pi_0 &= 0 \\
\pi_1 &= \mu_1 \\
\pi_{n+1} &= \mu_{n+1} - \sum_{k=0}^{n-1} \binom{n}{k} \pi_{k+1} \mu_{n-k} & (n \ge 1)
\end{dcases}
```

を得る。
